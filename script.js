eval(atob("LyogZXNsaW50LWRpc2FibGUgbm8tYWxlcnQgKi8KCmNvbnNvbGUubG9nKCd0ZXN0aW5nJyk7CgovKioqKioqKioqKioqKioKICogICBTTElDRSAxCiAqKioqKioqKioqKioqKi8KCmZ1bmN0aW9uIHVwZGF0ZUNvZmZlZVZpZXcoY29mZmVlUXR5KSB7CiAgY29uc3QgY29mZmVlQ291bnRlckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb2ZmZWVfY291bnRlcicpOwogIGNvZmZlZUNvdW50ZXJEaXYuaW5uZXJUZXh0ID0gY29mZmVlUXR5Owp9CgpmdW5jdGlvbiBjbGlja0NvZmZlZShkYXRhKSB7CiAgZGF0YS5jb2ZmZWUgKz0gMTsKICB1cGRhdGVDb2ZmZWVWaWV3KGRhdGEuY29mZmVlKTsKICByZW5kZXJQcm9kdWNlcnMoZGF0YSk7Cn0KCi8qKioqKioqKioqKioqKgogKiAgIFNMSUNFIDIKICoqKioqKioqKioqKioqLwoKZnVuY3Rpb24gdW5sb2NrUHJvZHVjZXJzKHByb2R1Y2VycywgY29mZmVlQ291bnQpIHsKICBwcm9kdWNlcnMuZm9yRWFjaChwcm9kdWNlciA9PiB7CiAgICBpZiAoY29mZmVlQ291bnQgPj0gcHJvZHVjZXIucHJpY2UgLyAyKSB7CiAgICAgIHByb2R1Y2VyLnVubG9ja2VkID0gdHJ1ZTsKICAgIH0KICB9KTsKfQoKZnVuY3Rpb24gZ2V0VW5sb2NrZWRQcm9kdWNlcnMoZGF0YSkgewogIHJldHVybiBkYXRhLnByb2R1Y2Vycy5maWx0ZXIocHJvZHVjZXIgPT4gcHJvZHVjZXIudW5sb2NrZWQpOwp9CgpmdW5jdGlvbiBtYWtlRGlzcGxheU5hbWVGcm9tSWQoaWQpIHsKICByZXR1cm4gaWQKICAgIC5zcGxpdCgnXycpCiAgICAubWFwKHdvcmQgPT4gd29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHdvcmQuc2xpY2UoMSkpCiAgICAuam9pbignICcpOwp9CgovLyBZb3Ugc2hvdWxuZCd0IG5lZWQgdG8gZWRpdCB0aGlzIGZ1bmN0aW9uLS0gaXRzIHRlc3RzIHNob3VsZCBwYXNzIG9uY2UgeW91J3ZlIHdyaXR0ZW4gbWFrZURpc3BsYXlOYW1lRnJvbUlkCmZ1bmN0aW9uIG1ha2VQcm9kdWNlckRpdihwcm9kdWNlcikgewogIGNvbnN0IGNvbnRhaW5lckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIGNvbnRhaW5lckRpdi5jbGFzc05hbWUgPSAncHJvZHVjZXInOwogIGNvbnN0IGRpc3BsYXlOYW1lID0gbWFrZURpc3BsYXlOYW1lRnJvbUlkKHByb2R1Y2VyLmlkKTsKICBjb25zdCBjdXJyZW50Q29zdCA9IHByb2R1Y2VyLnByaWNlOwogIGNvbnN0IGh0bWwgPSBgCiAgPGRpdiBjbGFzcz0icHJvZHVjZXItY29sdW1uIj4KICAgIDxkaXYgY2xhc3M9InByb2R1Y2VyLXRpdGxlIj4ke2Rpc3BsYXlOYW1lfTwvZGl2PgogICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGlkPSJidXlfJHtwcm9kdWNlci5pZH0iPkJ1eTwvYnV0dG9uPgogIDwvZGl2PgogIDxkaXYgY2xhc3M9InByb2R1Y2VyLWNvbHVtbiI+CiAgICA8ZGl2PlF1YW50aXR5OiAke3Byb2R1Y2VyLnF0eX08L2Rpdj4KICAgIDxkaXY+Q29mZmVlL3NlY29uZDogJHtwcm9kdWNlci5jcHN9PC9kaXY+CiAgICA8ZGl2PkNvc3Q6ICR7Y3VycmVudENvc3R9IGNvZmZlZTwvZGl2PgogIDwvZGl2PgogIGA7CiAgY29udGFpbmVyRGl2LmlubmVySFRNTCA9IGh0bWw7CiAgcmV0dXJuIGNvbnRhaW5lckRpdjsKfQoKZnVuY3Rpb24gcmVuZGVyUHJvZHVjZXJzKGRhdGEpIHsKICB1bmxvY2tQcm9kdWNlcnMoZGF0YS5wcm9kdWNlcnMsIGRhdGEuY29mZmVlKTsKICBjb25zdCBwcm9kdWNlckNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcm9kdWNlcl9jb250YWluZXInKTsKICBwcm9kdWNlckNvbnRhaW5lci5pbm5lckhUTUwgPSAnJzsKICBjb25zdCB1bmxvY2tlZFByb2R1Y2VycyA9IGdldFVubG9ja2VkUHJvZHVjZXJzKGRhdGEpOwogIHVubG9ja2VkUHJvZHVjZXJzLmZvckVhY2gocHJvZHVjZXIgPT4gewogICAgY29uc3QgcHJvZHVjZXJEaXYgPSBtYWtlUHJvZHVjZXJEaXYocHJvZHVjZXIpOwogICAgcHJvZHVjZXJDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvZHVjZXJEaXYpOwogIH0pOwp9CgovKioqKioqKioqKioqKioKICogICBTTElDRSAzCiAqKioqKioqKioqKioqKi8KCmZ1bmN0aW9uIGdldFByb2R1Y2VyQnlJZChkYXRhLCBwcm9kdWNlcklkKSB7CiAgcmV0dXJuIGRhdGEucHJvZHVjZXJzLmZpbmQocHJvZHVjZXIgPT4gcHJvZHVjZXJJZCA9PT0gcHJvZHVjZXIuaWQpOwp9CgpmdW5jdGlvbiBjYW5BZmZvcmRQcm9kdWNlcihkYXRhLCBwcm9kdWNlcklkKSB7CiAgY29uc3QgcHJvZHVjZXIgPSBnZXRQcm9kdWNlckJ5SWQoZGF0YSwgcHJvZHVjZXJJZCk7CiAgcmV0dXJuIHByb2R1Y2VyLnByaWNlIDw9IGRhdGEuY29mZmVlOwp9CgpmdW5jdGlvbiB1cGRhdGVQcmljZShvbGRQcmljZSkgewogIHJldHVybiBNYXRoLmZsb29yKG9sZFByaWNlICogMS4yNSk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZUNQU1ZpZXcoY3BzKSB7CiAgY29uc3QgY3BzRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NwcycpOwogIGNwc0Rpdi5pbm5lclRleHQgPSBjcHM7Cn0KCmZ1bmN0aW9uIGF0dGVtcHRUb0J1eVByb2R1Y2VyKGRhdGEsIHByb2R1Y2VySWQpIHsKICBpZiAoY2FuQWZmb3JkUHJvZHVjZXIoZGF0YSwgcHJvZHVjZXJJZCkpIHsKICAgIGNvbnN0IHByb2R1Y2VyID0gZ2V0UHJvZHVjZXJCeUlkKGRhdGEsIHByb2R1Y2VySWQpOwogICAgZGF0YS5jb2ZmZWUgLT0gcHJvZHVjZXIucHJpY2U7CiAgICBwcm9kdWNlci5xdHkgKz0gMTsKICAgIHByb2R1Y2VyLnByaWNlID0gdXBkYXRlUHJpY2UocHJvZHVjZXIucHJpY2UpOwogICAgZGF0YS50b3RhbENQUyArPSBwcm9kdWNlci5jcHM7CiAgICByZXR1cm4gdHJ1ZTsKICB9IGVsc2UgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gYnV5QnV0dG9uQ2xpY2soZXZlbnQsIGRhdGEpIHsKICBpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT09ICdCVVRUT04nKSB7CiAgICBjb25zdCBwcm9kdWNlcklkID0gZXZlbnQudGFyZ2V0LmlkLnNsaWNlKDQpOwogICAgY29uc3QgcmVzdWx0ID0gYXR0ZW1wdFRvQnV5UHJvZHVjZXIoZGF0YSwgcHJvZHVjZXJJZCk7CiAgICBpZiAoIXJlc3VsdCkgewogICAgICB3aW5kb3cuYWxlcnQoJ05vdCBlbm91Z2ggY29mZmVlIScpOwogICAgfSBlbHNlIHsKICAgICAgcmVuZGVyUHJvZHVjZXJzKGRhdGEpOwogICAgICB1cGRhdGVDb2ZmZWVWaWV3KGRhdGEuY29mZmVlKTsKICAgICAgdXBkYXRlQ1BTVmlldyhkYXRhLnRvdGFsQ1BTKTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIHRpY2soZGF0YSkgewogIGRhdGEuY29mZmVlICs9IGRhdGEudG90YWxDUFM7CiAgdXBkYXRlQ29mZmVlVmlldyhkYXRhLmNvZmZlZSk7CiAgcmVuZGVyUHJvZHVjZXJzKGRhdGEpOwp9CgovKioqKioqKioqKioqKioqKioqKioqKioqKgogKiAgU3RhcnQgeW91ciBlbmdpbmVzIQogKioqKioqKioqKioqKioqKioqKioqKioqKi8KCi8vIEZpcnN0LCBhIGNoZWNrIHRvIHNlZSBpZiB3ZSdyZSBpbiBhIHdlYiBicm93c2VyOyBpZiB3ZSdyZSBqdXN0IHJ1bm5pbmcgdGhpcyBjb2RlIGluIG5vZGUgZm9yIHB1cnBvc2VzIG9mIHRlc3RpbmcsIHdlIGRvbid0IHdhbnQgdG8gZG8gYWxsIG9mIHRoZXNlIHRoaW5ncy4KaWYgKHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJykgewogIC8vIEdldCBzdGFydGluZyBkYXRhIGZyb20gdGhlIHdpbmRvdyBvYmplY3QKICAvLyAoVGhpcyBjb21lcyBmcm9tIGRhdGEuanMpCiAgY29uc3QgZGF0YSA9IHdpbmRvdy5kYXRhOwoKICAvLyBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGdpYW50IGNvZmZlZSBlbW9qaQogIGNvbnN0IGJpZ0NvZmZlZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaWdfY29mZmVlJyk7CiAgYmlnQ29mZmVlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gY2xpY2tDb2ZmZWUoZGF0YSkpOwoKICAvLyBBZGQgYW4gZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNvbnRhaW5lciB0aGF0IGhvbGRzIGFsbCBvZiB0aGUgcHJvZHVjZXJzCiAgLy8gUGFzcyBpbiB0aGUgYnJvd3NlciBldmVudCBhbmQgb3VyIGRhdGEgb2JqZWN0IHRvIHRoZSBldmVudCBsaXN0ZW5lcgogIGNvbnN0IHByb2R1Y2VyQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2R1Y2VyX2NvbnRhaW5lcicpOwogIHByb2R1Y2VyQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQgPT4gewogICAgYnV5QnV0dG9uQ2xpY2soZXZlbnQsIGRhdGEpOwogIH0pOwoKICAvLyBDYWxsIHRoZSB0aWNrIGZ1bmN0aW9uIHBhc3NpbmcgaW4gdGhlIGRhdGEgb2JqZWN0IG9uY2UgcGVyIHNlY29uZAogIHNldEludGVydmFsKCgpID0+IHRpY2soZGF0YSksIDEwMDApOwp9IGVsc2UgaWYgKHByb2Nlc3MpIHsKICAvLyBUaGlzIGV4cG9ydHMgdGhlIGNvZGUgd3JpdHRlbiBoZXJlIHNvIHdlIGNhbiBpbXBvcnQgYW5kIHRlc3QgaXQgaW4gTW9jaGEKICBtb2R1bGUuZXhwb3J0cyA9IHsKICAgIHVwZGF0ZUNvZmZlZVZpZXcsCiAgICBjbGlja0NvZmZlZSwKICAgIHVubG9ja1Byb2R1Y2VycywKICAgIGdldFVubG9ja2VkUHJvZHVjZXJzLAogICAgbWFrZURpc3BsYXlOYW1lRnJvbUlkLAogICAgbWFrZVByb2R1Y2VyRGl2LAogICAgcmVuZGVyUHJvZHVjZXJzLAogICAgdXBkYXRlQ1BTVmlldywKICAgIGdldFByb2R1Y2VyQnlJZCwKICAgIGNhbkFmZm9yZFByb2R1Y2VyLAogICAgdXBkYXRlUHJpY2UsCiAgICBhdHRlbXB0VG9CdXlQcm9kdWNlciwKICAgIGJ1eUJ1dHRvbkNsaWNrLAogICAgdGljawogIH07Cn0K"));